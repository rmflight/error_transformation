---
title: "Visualizing Effect of Data Transformations on Errors"
author: "Robert M Flight"
date: "`r Sys.time()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(fakeDataWithError)
library(visualizationQualityControl)
library(cowplot)
```

# Introduction

Data transformations are frequently applied to different -omics data to change
properties of the data and make it more amenable to various statistical assumptions.
Included in the types of changes that are made include changing the error structure,
frequently from multiplicative errors that are commonly present in any data
generated by counts at a detector (essentially all -omics data) to additive errors,
which are more easily handled by most statistical methods.

# Methods



## Data

Simulated data was generated from an initial set of 10000 points drawn from 
a log-normal distribution with a mean in log-space of 1 and a standard deviation
of 1 (see histogram in Figure X). These data points are the **pure** initial 
data to which different types of error are added. From this set, 100 replicates are 
generated with either *additive*, *proportional* or *mixed* (both additive and
proportional) error.

```{r setup_data}
set.seed(1234)
n_point <- 10000
n_rep <- 100
simulated_data <- rlnorm(n_point, meanlog = 1, sdlog = 1)
```

```{r pure_histogram}
simulated_frame <- data.frame(abundance = simulated_data)
ggplot(simulated_frame, aes(x = abundance)) + geom_histogram(binwidth = 1) + 
  ggtitle("Pure Data")
```

### Additive Error

```{r add_error}
add_sd <- 2
add_error <- add_uniform_noise(n_rep, simulated_data, add_sd)
```

```{r add_plot}
add_rep <- data.frame(rep1 = add_error[,1], rep2 = add_error[,2])
add_plot <- ggplot(add_rep, aes(x = rep1, y = rep2)) + geom_point()
add_plot
```

Additive error was added where the standard deviation was `r add_sd`. A plot
of two replicates is shown in Figure X.

### Proportional Error

```{r prop_error}
prop_sd <- 0.1
prop_error <- add_prop_noise(n_rep, simulated_data, prop_sd)
```

```{r prop_plot}
prop_rep <- data.frame(rep1 = prop_error[, 1], rep2 = prop_error[, 2])
prop_plot <- ggplot(prop_rep, aes(x = rep1, y = rep2)) + geom_point()
prop_plot
```

Proportional error was added where the standard deviation was `r prop_sd`. A plot
of two replicates is shown in Figure X.

### Mixed Error

```{r mix_error}
mix_error <- add_prop_uniform(n_rep, simulated_data, add_sd, prop_sd)
```

```{r mix_plot}
mix_rep <- data.frame(rep1 = mix_error[, 1], rep2 = mix_error[, 2])
mix_plot <- ggplot(mix_rep, aes(x = rep1, y = rep2)) + geom_point()
mix_plot
```

Mixture of additive and proportional error was added with standard deviations
of `r add_sd` and `r prop_sd` respectively.

## Transformations



# Results



# Conclusion


# Create Markdown

```{r runit}
rmarkdown::render("glbio2016_manuscript.Rmd", clean = FALSE)
```
